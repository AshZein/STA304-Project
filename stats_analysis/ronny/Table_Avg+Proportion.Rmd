```{r adding proportions to the table}

# This chunk creates a table showing the annual average tickets issued for each infraction and the proportion of it

summary_infraction[
  ,
  proportion := total_tickets / sum(total_tickets)
]


combined_table <- summary_infraction[
  order(-avg_tickets_per_year_full_period),   # sort by highest average
  .(
    infraction_description,

    
    avg_tickets_per_year =
      format(
        round(avg_tickets_per_year_full_period, 2),
        big.mark = ",",
        nsmall = 2
      ),

    
    proportion =
      scales::percent(proportion, accuracy = 0.1)
  )
]


combined_preview <- head(combined_table, 10)


knitr::kable(
  combined_preview,
  col.names = c(
    "Infraction Description",
    "Avg Tickets Per Year",
    "Proportion of All Tickets"
  ),
  caption = "Top 10 Parking Infractions: Average Tickets Per Year and Proportion of Total Tickets"
)
```
